---
title: Two Wheel
description: A localizer that uses two odometry wheels
---

import {Accordions, Accordion} from "fumadocs-ui/components/accordion";

### Prerequisites
1. Two odometry wheels connected to motor encoder ports on a hub. One odometry wheel should be **parallel** to your robot's wheels, while the other should be **perpendicular** the the robot's wheels. 
2. A properly configured IMU. 

### Default Values

These are the default values of the TwoWheelConstants. Copy and paste this into your `Constants` file:

```java title="Constants.java"
    public static TwoWheelConstants twoWheelConstants = new TwoWheelConstants()
            .forwardTicksToInches(.001989436789)
            .strafeTicksToInches(.001989436789)
            .forwardY(1)
            .strafeX(2.5)
            .forwardEncoder_HardwareMapName("leftFront")
            .strafeEncoder_HardwareMapName("rightRear")
            .forwardEncoderDirection(Encoder.REVERSE)
            .strafeEncoderDirection(Encoder.FORWARD)
            .IMU_HardwareMapName("imu")
            .IMU_Orientation(new RevHubOrientationOnRobot(RevHubOrientationOnRobot.LogoFacingDirection.UP, RevHubOrientationOnRobot.UsbFacingDirection.LEFT));
```

## Steps

### 1. Switch to having a `twoWheelLocalizer` in the `createFollower` method.
- In the `createFollower` method, make sure that the `FollowerBuilder` returned has the desired `twoWheelLocalizer`.
```java title="twoWheelLocalizer.java"
    public static Follower createFollower(HardwareMap hardwareMap) {
        return new FollowerBuilder(followerConstants, hardwareMap)
                .mecanumDrivetrain(driveConstants)
                .twoWheelLocalizer(twoWheelConstants) // Add this line
                .pathConstraints(pathConstraints)
                .build();
    }
```    

### 2. Odometry Wheel Setup
Open the file `Constants` and navigate to `TwoWheelConstants`. Configure the following:

#### a. Encoder Ports:
Replace the `forwardEncoder_HardwareMapName` and `strafeEncoder_HardwareMapName` with the names of the ports connected to your encoders (odometry).
The names will match the hardware map names of the motor port that they are connected to.

- The `forwardEncoder_HarwareMapName` should be the name of the port connected to the odometry pod **parallel** to your wheels. 
- The `strafeEncoder_HardwareMapName` should be the name of the port connected to the odometry pod **perpendicular** to your wheels.

#### b. IMU Setup:
- Replace the `IMU_HardwareMapName` with the name of the configuration for your IMU.
- **Note:** Make sure that if you are using the control hub's built-in IMU, you have it configured to **port 0** on the **control hub**.
- Define the orientation of the IMU on the robot by changing the `RevHubOrientationOnRobot` value for `IMU_Orientation`. 
- Refer to [this resource](https://ftc-docs.firstinspires.org/en/latest/programming_resources/imu/imu.html?highlight=imu#physical-hub-mounting) to determine your IMU's `LogoFacingDirection` and `UsbFacingDirection`.

#### c. Odometry Measurements:
- Input the `forwardY` and `strafeX` values.
- These values represent the distance of the odometry wheels from the robot's center of rotation on the robot coordinate grid **in inches.**
- Use this diagram to find the signs these distances. This view is from the **top of the robot looking downwards.**

// REMOVED THE DIAGRAM TEMPORARILY

#### d. Encoder Directions:
The Encoder Directions can be changed by switching between `Encoder.REVERSE` and `Encoder.FORWARD` for `forwardEncoderDirection` or `strafeEncoderDirection`.

To ***Prepare*** to test directions: 
1. Push code to your robot.
2. Navigate and init the `Tuning` TeleOp.
3. Use Gamepad1 to navigate into the `Localizer[...]` folder and then select `Localization Test`

To ***Test*** for correct directions:
1. Press the play button and use the joysticks to move around
2. If the x value ticks down when the robot moves forward, reverse the direction of the forward pod.
3. If the y value ticks down when the robot moves left, reverse the direction of the strafe pod.

### 3. Localizer Tuning
We need to adjust multipliers that convert encoder ticks into real-world measurements: inches. This ensures your localizer's readings are accurate.

    #### a. Forward Tuner
    1. Position a ruler alongside your robot.

    2. Navigate and init the `Tuning` TeleOp.

    3. Use Gamepad1 to navigate into the `Localizer[...]` folder and then select `Forward Tuner`

    4. Press the Play Button

    5. Push the robot *forward* by the desired distance (default is 48 inches).

    6. The tuner will display two numbers:

        - **First number:** Distance the robot thinks it has traveled.

        - **Second number: the `multiplier`**

        - (Optional) Run multiple tests and average the multipliers for better accuracy.

    7. Input this value in `Constants` replacing the `.forwardTicksToInches(.001989436789)` with` .forwardTicksToInches([multiplier])`, where `[multiplier]` is the value you obtained from the tuner.

    #### b. Lateral Tuner
    1. Position a ruler alongside your robot.

    2. Navigate and init the `Tuning` TeleOp.

    3. Use Gamepad1 to navigate into the `Localizer[...]` folder and then select `Lateral Tuner`

    4. Press the Play Button

    5. Push the robot *sideways* (strafing) by the desired distance (default is 48 inches).

    6. The tuner will display two numbers:

        - **First number:** Distance the robot thinks it has traveled.

        - **Second number: the `multiplier`**

        - (Optional) Run multiple tests and average the multipliers for better accuracy.

    7. Input this value in `Constants` replacing the `.strafeTicksToInches(.001989436789)` with` .forwardTicksToInches([multiplier])`, where `[multiplier]` is the value you obtained from the tuner.

## Testing Your Localizer
After completing the tuning steps, you can test your localizer's accuracy.

To Test:
1. Navigate and init the `Tuning` TeleOp.
2. Use Gamepad1 to navigate into the `Localizer[...]` folder and then select `Localization Test`
3. Press the play button and use the joysticks to move around
4. Open Panels at http://192.168.43.1:8001/ while connected to robot wifi.

Observe the movements on the `Field View` gui. 
Moving the robot **forward** should make **x increase** and strafing **left** should make **y increase.**

## Common Issues
<Accordions type="single">
    <Accordion title="Heading is very off / moving the robot forward causes the heading to change dramatically">
        Double check the IMU orientations you configured. Often, an incorrect IMU orientation can also cause the reported x and y values to be incorrect. 
    </Accordion>
    <Accordion title="The reported x or y values are the opposite of what it should be">
        - If this happens in the x-direction, try reversing your forward encoder's direction. 
        - If this happens in the y-direction, try reversing your strafe encoder's direction. 
    </Accordion>
    <Accordion title="The x and y values are flipped">
        Double check whether the forward and strafe configurations are flipped. 
    </Accordion>
</Accordions>

Congratulations on successfully tuning your localizer!